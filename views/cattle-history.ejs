<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Cattle History</title>
  <link rel="stylesheet" href="/css/styles.css" />
  <style>
    .list { display: grid; grid-template-columns: 1fr 140px 160px 1fr; gap: 8px; align-items: center; }
    .row { padding: 10px; border-bottom: 1px solid #e9ecef; }
    .tag { display:inline-block; padding:2px 8px; border-radius:999px; font-size:.75rem; }
    .tag.miscarriage { background:#fff3cd; color:#664d03; }
    .tag.died { background:#f8d7da; color:#842029; }
    .hdr { font-weight:600; color:#0f5132; margin:16px 0 8px; }
  </style>
</head>
<body>
  <%- include('partials/header') %>
  <nav class="sidebar" id="sidebar">
    <div class="brand" style="display:flex; align-items:center;">
      <button class="close-sidebar" aria-label="Close navigation" style="background:transparent;border:none;cursor:pointer;margin-right:10px;position:relative;">
        <span style="display:block;width:20px;height:2px;background:#000;transform:rotate(45deg);position:absolute;top:50%;left:50%;transform-origin:center;margin:-1px 0 0 -10px;"></span>
        <span style="display:block;width:20px;height:2px;background:#000;transform:rotate(-45deg);position:absolute;top:50%;left:50%;transform-origin:center;margin:-1px 0 0 -10px;"></span>
      </button>
      <img src="/images/icons/logo.png" alt="Logo"><h1>Ferma Tech</h1>
    </div>
    <ul class="nav">
      <li><a href="/">Home</a></li>
      <li><a href="/community/dashboard">Farm Stats</a></li>
      <li><a href="/cattle-viewer">Cattle Viewer</a></li>
      <li><a href="/cattle-registry">Cattle Registry</a></li>
      <li><a href="/community/members">Members</a></li>
      <li><a href="/community/settings">Farm Settings</a></li>
      <li><a href="/community/data">Import/Export</a></li>
      <% if (typeof user !== 'undefined' && user && user.role === 'SuperAdmin') { %>
      <li><a href="/admin">Super Admin</a></li>
      <% } %>
    </ul>
  </nav>
  <main style="max-width:960px;margin:0 auto;padding:16px;">
    <h2 class="hdr">Miscarriages & Losses</h2>
    <% if ((losses||[]).length===0) { %>
      <div style="color:#6c757d;">No records found.</div>
    <% } else { %>
      <div class="list">
        <div class="row" style="font-weight:600;">Calf</div>
        <div class="row" style="font-weight:600;">Status</div>
        <div class="row" style="font-weight:600;">Birth Date</div>
        <div class="row" style="font-weight:600;">Mother</div>
        <% losses.forEach(function(l){ %>
          <div class="row"><a href="/profile/calf/<%= l.id %>"><%= l.name || ('Calf '+ l.id.slice(-4)) %></a></div>
          <div class="row"><span class="tag <%= l.status %>"><%= l.status.charAt(0).toUpperCase()+l.status.slice(1) %></span></div>
          <div class="row"><%= l.birthDate ? new Date(l.birthDate).toLocaleDateString() : '—' %></div>
          <div class="row"><% if (l.motherNumber) { %><a href="/profile/cow/number/<%= l.motherNumber %>"><%= l.motherName || l.motherNumber %></a><% } else { %>—<% } %></div>
        <% }) %>
      </div>
    <% } %>
  </main>
  <%- include('partials/footer') %>
</body>
</html>
